var ConnectFour={};ConnectFour.App=function(){this.player1=!1,this.isVsMachine=!1,this.board=[],this.coins=[],this.DEBUG=!0,this.setGameState_()},ConnectFour.App.prototype.setGameState_=function(){$("#button-man").on("click",function(){this.initGame_("man")}.bind(this)),$("#button-machine").on("click",function(){this.initGame_("machine")}.bind(this)),$("#button-replay").on("click",function(){this.refreshGame_()}.bind(this))},ConnectFour.App.prototype.initGame_=function(n){"machine"==n&&(this.isVsMachine=!0);this.initBoard_(6,7),this.showGameboard_()},ConnectFour.App.prototype.showGameboard_=function(){$(".introduction").addClass("is-hidden"),$(".gameboard, .instruction__title, .instruction").addClass("is-visable"),$(".outline").addClass("is-active")},ConnectFour.App.prototype.showEndScene=function(n){var o=n?"player 1":"player 2";$(".conclusion").addClass("is-active"),$(".conclusion__winner").html(o)},ConnectFour.App.prototype.refreshGame_=function(){location.reload()},ConnectFour.App.prototype.initBoard_=function(n,o){this.board=new ConnectFour.Board(n,o)},window.onload=function(){ConnectFour.app=new ConnectFour.App},ConnectFour.Coin=function(n,o){this.id=n,this.element=o,this.owner=null},ConnectFour.Coin.prototype.getOwner=function(){return this.owner},ConnectFour.Coin.prototype.setOwner=function(n){this.owner=n},ConnectFour.Coin.prototype.setColor=function(){this.owner?this.element.classList.add("player1"):this.element.classList.add("player2")},ConnectFour.Board=function(n,o){this.rows=n,this.columns=o,this.isPlayer1=!0,this.board=this.initBoard_(n,o),this.instruction=document.getElementsByClassName("instruction")[0],this.attachEventListeners_()},ConnectFour.Board.prototype.initBoard_=function(n,o){var t={};t.columns=[],t.element=document.getElementsByClassName("gameboard")[0];for(var e=0;e<o;e++){var i={};i.element=document.createElement("div"),i.element.id=e,i.element.className="gameboard__column",i.nextAvailable=n-1,i.coins=[];for(var s=0;s<n;s++){var r=document.createElement("div");r.className="gameboard__square",coin=document.createElement("div"),coin.id=s,coin.className="gameboard__coin",r.appendChild(coin),i.coins.push(new ConnectFour.Coin(s,coin)),i.element.appendChild(r)}t.columns.push(i),t.element.appendChild(i.element)}return t},ConnectFour.Board.prototype.attachEventListeners_=function(){var n=this;this.board.columns.forEach(function(o){$(o.element).on("click",function(){n.addCoin_(this.id),ConnectFour.app.isVsMachine&&setTimeout(function(){n.addCoin_(Math.floor(7*Math.random()))},1e3)})})},ConnectFour.Board.prototype.addCoin_=function(n){var o=this.board.columns[n].coins[this.board.columns[n].nextAvailable];this.isPlayer1?o.setOwner(!0):o.setOwner(!1),this.isPlayer1=!this.isPlayer1,this.updatePlayerInstruction_(),o.setColor(),--this.board.columns[n].nextAvailable,this.checkWinner_()},ConnectFour.Board.prototype.updatePlayerInstruction_=function(){this.isPlayer1?$(this.instruction).html("Player 1"):ConnectFour.app.isVsMachine?$(this.instruction).html("Machine"):$(this.instruction).html("Player 2"),$(".instruction__icon").toggleClass("player2")},ConnectFour.Board.prototype.checkWinner_=function(){this.matchHorizontal_(),this.matchVertical_()},ConnectFour.Board.prototype.matchHorizontal_=function(){for(var n=0;n<4;n++)for(var o=0;o<6;o++)this.board.columns[n+0].coins[o].owner===this.board.columns[n+1].coins[o].owner&&this.board.columns[n+0].coins[o].owner===this.board.columns[n+2].coins[o].owner&&this.board.columns[n+0].coins[o].owner===this.board.columns[n+3].coins[o].owner&&null!==this.board.columns[n+0].coins[o].owner&&null!==this.board.columns[n+1].coins[o].owner&&null!==this.board.columns[n+2].coins[o].owner&&null!==this.board.columns[n+3].coins[o].owner&&ConnectFour.app.showEndScene(this.board.columns[n+0].coins[o].owner)},ConnectFour.Board.prototype.matchVertical_=function(){for(var n=0;n<3;n++)for(var o=0;o<7;o++)this.board.columns[o].coins[n+0].owner===this.board.columns[o].coins[n+1].owner&&this.board.columns[o].coins[n+0].owner===this.board.columns[o].coins[n+2].owner&&this.board.columns[o].coins[n+0].owner===this.board.columns[o].coins[n+3].owner&&null!==this.board.columns[o].coins[n+0].owner&&null!==this.board.columns[o].coins[n+1].owner&&null!==this.board.columns[o].coins[n+2].owner&&null!==this.board.columns[o].coins[n+3].owner&&ConnectFour.app.showEndScene(this.board.columns[o].coins[n+0].owner)};